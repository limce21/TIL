## Azure 클라우드

---

### 클라우드 컴퓨팅

: 획기적인 기능을 더욱 빠르게 개발하고 리소스를 유동적으로 사용하는 동시에 요금을 대폭 절약할 수 있도록 인터넷을 통해 컴퓨팅 서비스를 제공

- 컴퓨팅
- 네트워킹
- 스토리지

### 공동 책임 모델

!https://learn.microsoft.com/ko-kr/azure/security/fundamentals/media/shared-responsibility/shared-responsibility.svg

- PaaS : 서비스만 쓰는 것
- SaaS : Office 365와 같은 것

### 프라이빗 클라우드

: 온 프라미스와 비슷. 회사에서만 접근하는 것

- 조직은 조직의 데이터 센터에 클라우드 환경 구축
- 서비스 운영에 대한 책임은 서비스를 제공하는 조직에 있음

### 퍼블릭 클라우드

- 클라우드 서비스 및 호스팅 공급자가 소유
- 여러 조직과 사용자에게 리소스(DB, 가상머신 등)와 서비스를 제공
- 보안 네트워크 연결을 통해 액세스(일반적으로 인터넷)

### 하이브리드 클라우드

: 퍼블릭 클라우드와 프라이빗 클라우드를 결합. 애플리케이션이 가장 적절한 위치에서 실행되도록 구성

- AAD (Azure Active Directory) : 퍼블릭 클라우드와 프라이빗 클라우드를 연결
  - 인증 권한 관리, 액세스 관리

### 클라우드 모델 비교

| 클라우드 모델   | 기능                                                        |
| --------------- | ----------------------------------------------------------- |
| 퍼블릭 클라우드 | - 조직은 사용하는 항목(리소스, 서비스)에 대해서만 비용 지불 |

- 애플리케이션을 신속하게 프로비전(서비스를 만든다.) 및 프로비전 해제 가능
- 확장시 자본 지출 없음 |
  | 프라이빗 클라우드 | - 구축 초기 및 유지 관리를 위한 하드웨어 구매 필요
- 조직이 리소스 및 보안을 모두 제어 가능
- 조직이 하드웨어 유지 관리 및 업데이트 필요 |
  | 하이브리드 클라우드 | - 조직이 애플리케이션을 실행한 위치 결정
- 최고의 유연성 제공
- 조직이 보안, 규정 준수 또는 법적 요구 사항 제어 |

### CapEX와 OpEX 비교

- CapEX (자본 지출)
  - 실제 인프라와 관련된 선불 지출
  - 시간이 지남에 따라 감소
- OpEX (운영 비용)
  - 필요에 따라 종량제로 제품 및 서비스 비용 지출
  - 즉시 청구됨

### 사용량 기반 모델

: 클라우드 서비스 공급자는 사용량 기반 모델로 운영된다. 즉, 최종 사용자는 사용하는 리소스의 비용만 지불한다.

## 클라우드 서비스 유형

---

### IaaS

: 클라우드 공급자의 서버, 가상 머신, 스토리지, 네트워크 및 운영 체제를 대여하여 종량제 IT 인프라를 구축

- 가장 유연한 클라우드 서비스
- 사용자가 애플리케이션을 위한 하드웨어를 구성 및 관리

### PaaS

: 기본 인프라 관리에 신경쓸 필요 없이 소프트웨어 애플리케이션을 빌드, 테스트 및 배포할 수 있는 환경을 제공

- 어플리케이션 개발에 중점
- 클라우드 공급자가 플랫폼 관리를 담당

### SaaS

: 사용자는 인터넷을 통해 Microsoft Office 365, 전자 메일 및 캘린더와 같은 클라우드 기반 앱에 연결하고 사용

- 종량제 가격 책정 모델
- 사용자는 구독 모델로 사용하는 소프트웨어에 대해 비용을 지불

<aside>
💡 **트래픽이 늘어나면 자동으로 서버를 늘려준다.**

</aside>

## 리소스와 리소스 그룹

---

### 리소스

: Azure 리소스 관리자가 관리하는 가상머신, 가상 네트워크, 스토리지 계정, 부하분산 장치 등을 말함

- Azure Storage, Virtual Machine 등과 같은 리소스들을 필요에 따라 그룹화
- **리소스는 반드시 리소스 그룹에 포함되어야 한다.**
  - 없으면 관리가 복잡해지고, 프로젝트가 커지면 유지보수가 힘들어진다.

### 리소스 그룹

: 프로젝트 단위나 역할 중심으로 리소스 그룹 생성

- 역할 중심의 간단한 예로 프론트엔드, 백엔드 형태로 나눈다.
- `태그`를 활용하여 애플리케이션, 환경처럼 필요한 정보나 비용 등을 태그를 이용해서 구분할 수 있다.

### 리소스와 리소스 그룹의 관계

- 리소스는 하나의 리소스 그룹에만 존재해야 한다.
- 리소스와 리소스 그룹 이름은 생성 후 변경이 불가하다.
  - 정 바꾸고 싶으면 삭제하고 다시 생성해라.
- 동일한 구독 내에서 리소스 그룹 이름은 중복 불가하다.
- 리소스 그룹과 리소스 위치(지역)은 다를 수 있다.
- 리소스 그룹의 수명이 곧 리소스의 수명이다.
- 한 리소스 그룹 내의 리소스와 다른 리소스 그룹의 리소스는 상호작용이 가능하다.
- 한 리소스 그룹의 리소스는 다른 리소스 그룹으로 선택적으로 이동이 가능하다.
  - 단, 가상머신 이동은 권장 X, 차라리 새로 만들어라.

### Azure 리소스 관리자 (ARM)

: Azure용 배포 및 관리 서비스

- Azure 계정에서 리소스를 만들고, 업데이트하고, 삭제할 수 있는 관리 계층
- 배포 이후 액세스 제어, 잠금 및 태그와 같은 관리 기능을 이용하여 리소스 보호 구성

### 리소스 공급자

: Azure 리소스를 제공하는 서비스, 리소스 공급자는 계정에 배포할 수 있는 Azure 리소스를 정의한다.

- 가상 머신을 생성하는 경우 - `Microsoft Compute`
- 스토리지 생성하는 경우 - `Microsoft Storage`
- 리소스 공급자 확인 방법 - 구독 → 리소스 공급자 선택
- AI와 같은 특수한 환경은 모듈이 기본적으로 없기에 붙여줘야 한다.

### 실습 - Azure Portal을 이용한 리소스, 리소스 그룹 관리

1. 리소스 그룹과 리소스 생성

   - 지역에는 TO가 있다. (그나마 빠른게 Korea, East US, East Japan 이고 나머지는 느리니까 참고)
   - 가용성 영역 : 백업 시스템을 두는 것. (하나의 시스템이 이상해도, 다른 영역에서 백업해서 사용 가능하도록)

   ![스크린샷 2023-07-17 오전 10.27.15.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/7b62df2b-a368-433b-8594-1adf03fbdb18/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_10.27.15.png)

   ![스크린샷 2023-07-17 오전 10.27.23.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/1cbbb4d0-8e1d-4c67-a6c7-c9a8d2ed23ae/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_10.27.23.png)

   ![스크린샷 2023-07-17 오전 10.31.43.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/71e167e7-a061-488c-8871-f49856249655/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_10.31.43.png)

   ![스크린샷 2023-07-17 오전 10.34.16.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/1b54d395-79ef-45a6-928e-80184984ff85/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_10.34.16.png)

   ![스크린샷 2023-07-17 오전 10.35.08.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/69e11571-0f73-46f3-886c-a81741564ce4/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_10.35.08.png)

2. 리소스 그룹 간의 리소스 이동
   - 이동에는 시간이 꽤나 소요된다.
3. 리소스 락(lock) 테스트 (Delete lock을 걸면 리소스 그룹이 삭제 안 된다.)
   - 잠금은 삭제 / 읽기 가능하다.

## Azure PowerShell / CLI

---

### Azure PowerShell

: 명령줄 셀, 스크립팅 언어 및 구성 관리 프레임워크로 구성된 플랫폼 간 작업 자동화 솔루션

- Windows, Linux 및 macOS에서 실행 가능

### Azure CLI

: Azure 리소스를 만들고 관리하는 데 사용되는 명령도구

- 모든 Azure 서비스에서 사용할 수 있으며, Azure를 빠르게 사용할 수 있도록 지원
- Windows, Linux 및 macOS에서 실행 가능

### Azure Cloud Shell 활성화

![스크린샷 2023-07-17 오전 10.46.58.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/49e067be-3b8a-4575-bd1b-b350994bbca2/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_10.46.58.png)

![스크린샷 2023-07-17 오전 10.48.24.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/0e5bd959-31a8-4ede-9b8e-ef71661eac5c/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_10.48.24.png)

⇒ 위치에 제한이 있을 수 있어서 실패할 수도 있다.

**[ 구독 검색 ]**

`az account list -o table`

- 참고) table을 붙이면 형태가 예쁘게 나온다.

![스크린샷 2023-07-17 오전 11.07.16.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/838b6d9a-5f1c-4477-9999-79c4f724383c/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_11.07.16.png)

**[ 모든 리소스 검색 ]**

`az resource list -o table`

![스크린샷 2023-07-17 오전 11.08.39.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/0da6cf9b-39de-4d21-ab5f-ce68c3f8ba84/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_11.08.39.png)

## Azure 스토리지

---

### Azure 스토리지

: Microsoft 클라우드 데이터 서비스의 핵심

- 3가지 유형의 데이터 유형의 저장소일 뿐만 아니라 대용량 데이터 저장 및 분석처럼 최신 데이터 저장소 시나리오를 지원하는 솔루션

1. 정형 데이터

   : 고정된 칼럼에 저장되거나 정해진 스키마에 의해 구조화

   - RDBMS 테이블, 스프레드 시트

2. 반정형 데이터

   : 스키마에 해당하는 메타데이터가 내부에 존재

   - HTML, XML, JSON, YAML

3. 비정형 데이터

   : 데이터가 그 자체로 존재, 구조화되어 있지 않음

   - 문서, 동영상, 이미지 등과 같은 이진 데이터

### 장점

1. 뛰어난 내구성 및 고가용성
2. 보안성
3. 확장성
4. 원활한 액세스 가능하고 개발의 편리성 제공

### Azure 스토리지 계정

- 표준 범용 v2 : Blob, 파일, 큐, 테이블 및 Data Lake Storage를 비롯한 대부분의 시나리오
- Premium 블록 Blob : 트랜잭션 속도가 높은 블록 Blob 시나리오 또는 더 작은 개체를 사용하거나 일관되게 짧은 스토리지 대기 시간이 필요한 시나리오에 추천
- 프리미엄 파일 공유 : 기업 또는 고성능 파일 공유 애플리케이션
- 프리미엄 페이지 Blob : 프리미엄 고성능 페이지 Blob 시나리오

### Azure 스토리지 서비스

- **Azure 컨테이너(Blob)** : 대규모로 스케일링 가능한 텍스트, 이진 데이터용 저장소. **비구조화된 데이터에 최적화**
- Azure 테이블(Table) : 구조적 비관계형 데이터 저장에 적합
- Azure 큐(Queue) : 애플리케이션 간에 안정적인 메시징을 위한 메시지 저장소
- Azure Files : 클라우드 또는 온-프레미스 배포에 대한 관리형 파일 공유

### 중복 / 복제 옵션

: Azure 스토리지는 하드웨어 오류, 네트워크 중단, 자연 재해 등의 예측 불가능한 상황. 보안 폐지, 업데이트 등과 같은 예정된 작업시 데이터 보호를 위해 여러 개의 복사본을 저장

**[ 단일 영역 ]**

- LBS
  - 복제본 3개, 지역 1개
  - 디스크, 노드, 렉 오류로부터 보호
  - 모든 복제본이 커밋될 때 쓰기가 승인된다.
  - 이중 패리티 RAD보다 우수
- ZRS
  - 복제본 3개, 영역 3개, 지역 1개
  - 디스크, 노드, 렉 및 영역 오류로부터 보호
  - 세 영역 모두에 동기 쓰기

**[ 다중 영역 ]**

- GRS
  - 복제본 6개, 지역 2개(지역당 3개)
  - 주요 지역 재해로부터 보호
  - 보조에 대한 비동기 복사본
- RA-GRS
  - 보조에 대한 GRS + 읽기 액세스
  - 별도의 보조 엔드포인트
  - RPO(복구 지점 목표) 지연을 보조로 쿼리할 수 있음

### 실습 - 스토리지 계정 만들기

![스크린샷 2023-07-17 오전 11.32.01.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/a586d717-572e-4030-bcba-0e1c71467beb/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_11.32.01.png)

- `st` → storage의 약어

![스크린샷 2023-07-17 오전 11.35.20.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/23ece416-bca2-45d3-beeb-3217f6c8e183/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_11.35.20.png)

![스크린샷 2023-07-17 오전 11.37.30.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/ed30ff81-15cc-46c6-ab7c-e7199aa14007/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_11.37.30.png)

![스크린샷 2023-07-17 오전 11.38.13.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/a7931fe4-5f43-448c-8d35-442f725f7ccb/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_11.38.13.png)

![스크린샷 2023-07-17 오전 11.38.29.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/3d90e890-8be0-4f9d-b3ea-84424a5dce80/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_11.38.29.png)

### Blob Storage

: 개체 스토리지라고도 하며 구조화되지 않은 데이터를 저장(이진 텍스트, 이진 데이터).

- 브라우저에 직접 이미지 또는 문서 제공
- 분산 액세스용 파일 저장
- 비디오, 오디오, 스트리밍
- 백업 및 복원, 재해복그, 보관용으로 데이터 저장
- 온-프레미스 또는 Azure 호스팅 서비스에 대해 분석하기 위한 데이터 저장

### Blob 컨테이너 만들기

- 모든 Blob은 컨테이너 안에 있어야 한다.
- 계정에는 무제한의 컨테이너가 존재할 수 있다.
- 컨테이너 안에 무제한의 Blob이 존재할 수 있다.
- 개인 Blob - 익명 액세스 없음
- Blob - Blob 익명 읽기 액세스

### Blob 계층 만들기

- 핫 : 스토리지 계정에서 개체에 빈번한 액세스가 있는 경우
- 쿨 : 자주 액세스하지 않으며 30일이상 저장되는 대량의 데이터 저장에 적합
- 보관 : 검색 대기 시간에 몇 시간이 걸려도 괜찮으며, 180이상 저장

### 실습 - 이미지 업로드

![스크린샷 2023-07-17 오전 11.46.19.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/b2b6a10a-5680-48a3-ad69-745bd29c352f/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_11.46.19.png)

![스크린샷 2023-07-17 오전 11.46.31.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/de0218e2-14d1-4921-8964-cd9df3f6584a/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_11.46.31.png)

![스크린샷 2023-07-17 오전 11.47.56.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/23044d56-409e-4b39-975a-d58a2ba59e2a/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_11.47.56.png)

![스크린샷 2023-07-17 오전 11.48.33.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/82211b1b-19a6-42a8-b7e8-4f672dd44a4c/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_11.48.33.png)

![스크린샷 2023-07-17 오후 12.02.05.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/6018b388-aeb6-4aee-9b87-d33f358d0ff9/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_12.02.05.png)

![스크린샷 2023-07-17 오후 12.02.17.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/a7e27f99-ddf5-4188-a769-2a09cefe4352/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_12.02.17.png)

<aside>
⛔ **왜 에러가 나올까?**

</aside>

- 우리가 private으로 설정해놨기에 볼 수 없다.

![스크린샷 2023-07-17 오후 12.03.58.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/07fcb178-ff9d-44f9-9582-897bce9faf1b/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_12.03.58.png)

![스크린샷 2023-07-17 오후 12.04.12.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/32c7476a-90f8-449a-8506-3fc9a104b22d/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_12.04.12.png)

⇒ 액세스 수준을 변경하니 보인다.

### 파일 공유

- Azure는 SMB 프로트콜을 사용해 파일 공유 기능을 제공한다.
- 여러 대의 VM이 같은 네트워크 드라이브를 공유하고 파일에 대한 읽기/쓰기 가능
- 로그나 데이터 파일들을 공유해 추후 분석 가능
- 파일 공유는 윈도우, 리눅스, 맥OS에서 연결 가능
- 온-프레미스나 다른 클라우드 VM에서 파일 공유를 사용할 경우 SMB 포트인 TCP 445 열려 있는지 확인 필요

### 실습 - 파일 공유

![스크린샷 2023-07-17 오후 12.11.13.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/3649f26f-f5e2-4a62-b43e-b5988b8af293/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_12.11.13.png)

![스크린샷 2023-07-17 오후 12.11.42.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/74d30714-61dc-42b1-9f3f-d19dad8f8776/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_12.11.42.png)

![스크린샷 2023-07-17 오후 12.12.11.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/a4e4c8c4-7ba0-4c85-9557-cbacc9a5752c/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_12.12.11.png)

![스크린샷 2023-07-17 오후 12.13.29.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/cdfa179d-23e8-4474-812c-8e58dc8ce76d/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_12.13.29.png)

### 가상 머신

: 운영 체제, 스토리지, 네트워킹 기능 등을 제공

- Azure App Service, Cloud Service 등과 비교하여 보다 강력하게 컴퓨팅 환경 구축 가능 가상 머신은 IaaS
- 필요에 따라 신속하게 스케일 업, 스케일 다운 가능

### 가상머신 생성 구성 요소

- 리소스 그룹
  - 가상 머신을 포함할 기존 리소스 그룹을 선택하거나 새롭게 생성
- 가상 머신 이름
  - 보통 vm을 붙여서 이름설정.
  - Windows VM의 경우 최대 15자
  - Linux VM 경우 최대 64자
  - 가상머신에서 수행하는 작업, 지역을 쉽게 식별할 수 있도록 의미있고 일관성있게 정의.
    ex) webvm-korean
- 지역(위치) 및 비용
  - 가상 머신을 만들고 배포할 지역 설정
  - 배포 위치에 따라 법적 제한 사항, 규정 준수, 세금 관련 부분이 차이가 존재할 수 있으므로 이를 고려하며 설정이 필요
  - 지역에 따라서 사용 가능한 옵션에 제공하지 않은 경우도 있고, 가격 차이 존재
  - 가상 머신에 부과되는 비용은 시간당 가격으로 책정되지만 실제로는 분당 요금으로 청구되는 컴퓨팅 비용과 VM에서 사용하는 스토리지에 부과되는 비용으로 구성
- 가용성 옵션
  - 가용성은 가상머신이 정상적으로 사용 가능한 정도
  - 예상치 못한 문제 발생에 대한 대비로 가용성 영역, 가상머신 확장집합, 가용성 집합을 설정하는 옵션으로 기본값은 인프라 중복안함
- 이미지(운영체제)
  - 가상머신을 만들 때 사용하는 운영체제 이미지
    ex) Windows, Linux
- 크기(가상머신 크기)
  - Azure는 처리 능력, 메모리, 스토리지 용량을 독립적으로 지정하는 대신, 해당 요소들에 대한 다양한 VM 크기를 제공
  - 적절한 VM 크기를 결정하는 기준은 VM에서 실행하는 워크로드의 유형을 따른다
- 디스크
  - 가상머신에 운영체제를 설치하고 응용 프로그램을 실행하기 위해 운영체제를 위한 디스크와 임시 디스크 필요. 프리미엄 SSD, 표준 SSD
  - 사용자가 보관해야 할 필요가 있는 데이터를 저장하기 위한 데이터 디스크
  - 가상 머신에서 사용하는 모든 디스크는 모든 고정 크기의 VHD
- 네트워킹
  - 기존 가상 네트워크 선택 및 새로운 가상 네트워크 추가
  - 기존 서브넷 선택ㄱ 및 새로운 서브넷 구성
  - 기존 공용 IP 선택 및 새로운 공용 IP 생성
  - NIC 생성

### 실습 - 가상머신 생성 (Windows)

![스크린샷 2023-07-17 오후 12.31.14.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/3df710bb-608f-43bd-8434-5c04bff35f60/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_12.31.14.png)

![스크린샷 2023-07-17 오후 12.37.06.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d1690e2f-1a22-442b-ad79-2a8a2302ee6c/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_12.37.06.png)

![스크린샷 2023-07-17 오후 12.37.03.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/29a3f6d0-02f1-4198-b5cb-60b1adabdb7e/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_12.37.03.png)

![스크린샷 2023-07-17 오후 12.37.59.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/6745f9b5-8a64-4d10-bf49-0c138afadb13/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_12.37.59.png)

![스크린샷 2023-07-17 오후 12.39.15.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/baff5e65-7b10-40a4-9c80-18efb35763e1/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_12.39.15.png)

![스크린샷 2023-07-17 오후 12.40.04.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/1e6d4912-2196-48e2-b55e-14eb028a98ba/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_12.40.04.png)

![스크린샷 2023-07-17 오후 12.40.43.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/40d8691d-17a0-43a9-938f-a9a491035b3c/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_12.40.43.png)

![스크린샷 2023-07-17 오후 12.40.56.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/769d4871-b04c-46f9-8119-1a1a9b8649d2/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_12.40.56.png)

![스크린샷 2023-07-17 오후 12.47.51.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/2ea37f90-1f7f-483c-96cf-ec1ab05ab49e/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_12.47.51.png)

![스크린샷 2023-07-17 오후 2.05.28.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/df139e1c-669d-4b3d-8c7f-4f4dcce1d0ab/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.05.28.png)

![스크린샷 2023-07-17 오후 2.05.44.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/616c8f05-dcfe-4e23-a02c-62984c77c655/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.05.44.png)

[맥에서 Windows 10 원격 데스크톱 접속하는 방법](https://www.lainyzine.com/ko/article/how-to-access-windows-10-remote-desktop-from-mac/)

![스크린샷 2023-07-17 오후 2.11.12.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/b2a9be70-cd7a-44f8-8010-d2005ae83777/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.11.12.png)

![스크린샷 2023-07-17 오후 2.13.42.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/18681421-133f-48bf-bd3d-a302c70b3b93/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.13.42.png)

![스크린샷 2023-07-17 오후 2.16.33.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/be113303-09c2-473b-8d4f-b7ff8471fa85/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.16.33.png)

![스크린샷 2023-07-17 오후 2.16.50.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/346fc950-8a0f-4e00-a069-be23fa257470/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.16.50.png)

![스크린샷 2023-07-17 오후 2.19.35.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d5d72469-4624-42f0-9da3-7aa37c6999cd/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.19.35.png)

![스크린샷 2023-07-17 오후 2.20.37.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/503d289c-738b-477c-8034-320a4c65725d/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.20.37.png)

![스크린샷 2023-07-17 오후 2.20.59.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/4ba42827-59cf-453d-8116-eb8c98dd52cf/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.20.59.png)

![스크린샷 2023-07-17 오후 2.21.29.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/df3cce76-eadf-4ebc-b9c9-08afd864805e/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.21.29.png)

![스크린샷 2023-07-17 오후 2.23.56.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/c4880b19-d8c2-43b2-9be1-5e599927b33f/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.23.56.png)

![스크린샷 2023-07-17 오후 2.25.09.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/6fd53fcc-4ea5-49d1-b890-ea362433b716/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.25.09.png)

![스크린샷 2023-07-17 오후 2.26.26.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/5f7b3bf1-e312-40f1-9186-427cbde83245/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.26.26.png)

![스크린샷 2023-07-17 오후 2.27.04.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/1a251840-c3d1-468e-878b-e8022e43e5a6/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.27.04.png)

<aside>
💡 **가상머신에 저장한 log.txt가 스토리지에 들어와있다! ↔ 반대도 가능**

</aside>

### 실습 - 가상머신 지우기

- 계속 사용해야 하는데 당장은 사용하지 않는다면 → `중지`
  ⇒ 가상머신 비용 절감

![스크린샷 2023-07-17 오후 2.34.42.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/123e9aa4-c768-4cad-8488-75423cfd9ea8/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.34.42.png)

- 리소스 그룹 삭제 : `az group delete --name {리소스그룹명} --no-wait --yes`
  - `--no-wait --yes` : 여러 개 있어도 상관쓰지말고 그냥 지워라

### 실습 - 가상머신 생성 (Linux)

![스크린샷 2023-07-17 오후 2.45.42.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/c4d8dc25-8cb7-4987-b80d-b85548f5a344/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.45.42.png)

![스크린샷 2023-07-17 오후 2.46.15.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/6d469cbb-7834-4fb1-a236-975946594d05/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.46.15.png)

- 인바운드 : 들어오는 것. PC에서 가상머신을 연결할 때 어떤 포트를 선택할거냐

![스크린샷 2023-07-17 오후 2.47.06.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/885e2e1d-04a9-485e-988e-934c0a08e0c3/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.47.06.png)

![스크린샷 2023-07-17 오후 2.47.45.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/aa2048bf-7cf4-48e2-8af4-ea3d666b9414/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.47.45.png)

- Azure Load Balancer && 애플리케이션 게이트웨이 : 엄청난 비용 소모. 비싼 자원

![스크린샷 2023-07-17 오후 3.02.20.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/a7bc325c-644f-4129-bd0f-b05bd1b55008/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_3.02.20.png)

![스크린샷 2023-07-17 오후 3.02.49.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/51ad923e-ed61-4934-9f61-78e528793323/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_3.02.49.png)

- 키가 다운로드 된다.

![스크린샷 2023-07-17 오후 3.03.35.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/0afea83a-f36b-43d2-b6a2-801ea77e6389/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_3.03.35.png)

![스크린샷 2023-07-17 오후 3.04.21.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/1fa0652f-913f-4891-832a-985e99830e6c/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_3.04.21.png)

![스크린샷 2023-07-17 오후 3.04.28.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/bc7ded49-28f8-4bac-afdd-894980bc167e/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_3.04.28.png)

- Permission Denied 오류가 떴다.

[SSH: Permission denied (publickey). - Microsoft Q&A](<https://learn.microsoft.com/en-us/answers/questions/1115347/ssh-permission-denied-(publickey)>)

![스크린샷 2023-07-17 오후 3.29.09.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/fc0cb144-ea00-48ae-9a32-018e8bdb90bd/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_3.29.09.png)

![스크린샷 2023-07-17 오후 3.26.16.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/20af7025-af02-48eb-854e-314d3c4d99c6/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_3.26.16.png)

![스크린샷 2023-07-17 오후 3.30.48.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/ddb5db5b-4df7-4044-88b3-f9c036002b20/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_3.30.48.png)

![스크린샷 2023-07-17 오후 3.32.41.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/5cca64c2-dccb-43d2-a0dd-ce764706093a/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_3.32.41.png)

![스크린샷 2023-07-17 오후 3.34.42.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/2ba62f3d-e8b2-4bc5-932b-5233d9284a08/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_3.34.42.png)

- abc.txt가 보인다.

### 가상 머신 크기 조정

- 이미 배포된 가상머신의 CPU, 메모리, 표준 SSD에서 프리미엄 SSD로 변경, 데이터 디스크 추가
- **가상 머신을 중단하고 해야함!**

### Azure PowerShell을 이용한 리소스, 리소스 그룹 생성

![스크린샷 2023-07-17 오후 4.01.12.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/6cb0aa6c-7704-4b04-89e7-243bd5ed8d98/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.01.12.png)

![스크린샷 2023-07-17 오후 4.01.47.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/354346f5-c548-4482-97b6-b47f8fb4bf3c/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.01.47.png)

1. `New-AzResourceGroup` 명령을 이용한 리소스 그룹 생성
2. `New-AzDisk` 명령을 이용한 Disk 생성

   ![스크린샷 2023-07-17 오후 4.10.46.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/eb5e8462-48b9-43ec-85a9-59bcf952a8b1/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.10.46.png)

   ![스크린샷 2023-07-17 오후 4.11.01.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/030fbe10-36c4-4f23-96b7-9c3059628d43/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.11.01.png)

## ARM Template

---

### ARM Template

: 인프라를 정의하는 개념인 IaC(Infra as Code)의 한 형태

- Azure Portal에서 VM, Storage를 생성하기 위해 클릭할 필요 없이 **key-value 쌍으로 이루어진 JSON 형태**의 ARM template을 이용.
- 리소스를 정의하고 Azure Resource Manager가 생성하도록 한다.

### 선택해야 하는 이유?

1. 선언적 구문 사용과 일관되고 반복적인 배포 가능
2. CI/CD 통합
3. 오케스트레이션

### 기본 구조

- 키(key) - 값(value) 쌍의 컬렉션
- 각 키(key)는 문자열
- 각 값(value)은 문자열, 숫자, 부울 값, 값 목록, 개체

### 매개변수

- 리소스를 배포할 때 입력할 수 있는 값을 지정
- adminUsername, adminPassword 매개 변수를 정의한 예
- metadata는 매개변수에 대한 설명
- securestring은 모든 암호과 비밀데이터에 사용
  - 리소스 배포 후에 읽을 수 없다.

### 변수

- 복잡한 식을 반복하는 대신 복잡한 식을 포함하는 변수를 저으이
  ⇒ “`variables`”
  - 템플릿을 단순화함
- 데이터 형식 지정 안함
- 매개변수 또는 다른 변수값 사용
- 변수 사용
  - **variables(variablename) 함수**

### 함수

- 템플릿 기본 함수와 사용자 정의 함수
- 함수 호출 형식
  ⇒ `functionname(arg1, arg2, …)`
- 함수에서 반환된 개체의 속성
  ⇒ `functioname().property`

### 실습

![스크린샷 2023-07-17 오후 4.31.37.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/b930626a-9777-4199-acff-d66fb6df2400/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.31.37.png)

![스크린샷 2023-07-17 오후 4.35.55.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d82081cc-12d9-4c8c-a7d8-ceae5059a9c1/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.35.55.png)

![스크린샷 2023-07-17 오후 4.37.54.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/b1002bca-28d2-492c-ae5d-4e30212f9f20/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.37.54.png)

![스크린샷 2023-07-17 오후 4.36.22.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/b0474fa6-d942-4024-976d-5620f2aaf098/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.36.22.png)

- 템플릿 편집 → Source Resource ID, HyperVgeneration 삭제
- 매개변수 편집 → diskName 이름 바꾸기

![스크린샷 2023-07-17 오후 4.42.07.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/486d595a-af3c-4185-9265-a79aa55ba6fa/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.42.07.png)

![스크린샷 2023-07-17 오후 4.42.59.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/bf042830-583f-432f-87a7-3d4a088ae517/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.42.59.png)

### 다 삭제하자

![스크린샷 2023-07-17 오후 5.00.26.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/477414de-9593-44ce-8dab-c2e40e2e496f/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_5.00.26.png)

![스크린샷 2023-07-17 오후 5.00.58.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/be54876c-ba6c-4625-8a1c-c59c42a18fd6/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_5.00.58.png)

![스크린샷 2023-07-17 오후 5.04.09.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/c4b9d7bd-7ea3-4d66-8340-0d5ffa0a4a15/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_5.04.09.png)

![스크린샷 2023-07-17 오후 5.05.05.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/ecf0ee00-6308-4e92-a1e5-a344a3b9d3eb/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_5.05.05.png)

- vault → 백업용

## 가상 머신 가용성

---

### 가상 머신 가용성

: 가동률과 비슷한 개념

- 정상적인 가동시간(uptime)을 전체 가동시간(uptime + downtime)으로 나눈 값
- 가상 머신의 가용성은 계획되지 않은 하드웨어 유지관리, 계획된 유지관리, 예측하지 못한 다운타임에 의해 영향을 받음
- 가상 머신의 중복성 구현에 가용성 집합 사용
- 가용성 영역이나 가용성 집합과 부하분산 장치를 결합

### 가용성 집합

: 하나의 데이터센터에서 가상 머신의 중복성과 가용성을 제공하는 서비스

- 가용성 집합에 포함된 가상 머신들을 각각 업데이트 도메인, 장애 도메인에 할당
- 각 가용성 집합은 최대 3개의 장애 도메인과 20개의 업데이트 도메인으로 구성 가능

### 업데이트 및 장애 도메인

- 업데이트 도메인 : Azure가 배포 전체에서 증분 또는 롤링 업그레이드를 수행할 수 있다.
- 장애 도메인 : 단일 실패 지점을 공유하는 공통 하드웨어 집합인 스위치를 공유하는 가상머신 그룹

### 수직과 수평 크기 비교

- 수직 스케일링 : 워크로드의 단일 인스턴스. 전력을 늘리거나 줄이는 프로세스. 대부분 수동으로 수행
- 수평 스케일링 : 워크로드의 인스턴스 수를 늘리거나 줄이는 프로세스. 대부분 자동으로 수행

### 실습 - 가용성 집합 구현

1. Azure Portal 로그인
2. Azure Portal에서 ‘Korea Central’, ‘East US’ 등의 지역에 가상 네트워크와 서브넷 생성
3. 생성된 서브넷에 2개의 VM을 가용성 집합으로 배포

## ✏️ 복습 TIME

---

> 윈도우 10 가상 머신 만들고, 하드디스크 32GB 추가, 공유 폴더 만들어 이미지를 공유해 하드디스크가 볼 수 있도록

![스크린샷 2023-07-17 오후 5.28.16.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e3147191-bc58-440d-935f-98ad6c195c9a/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_5.28.16.png)

![스크린샷 2023-07-17 오후 5.25.59.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/df8dc2d7-0d49-496d-bb7d-12bb9e794ad5/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-17_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_5.25.59.png)

<aside>
🤗 **성공!**

</aside>

## 가상 네트워크

---

### 가상 네트워크

: Azure Private Network의 기본 리소스

- VNet을 이용하여 Azure VM(Virtual Machine)이 서로 인터넷 및 온-프레미스 네트워크를 통해 안전한 통신 제공

### 사용하는 이유

1. Azure 리소스 간의 안전한 통신
   - Azure VNet 안에서 가상머신 간의 통신
   - 가상머신과 다른 Azure 서비스 사이의 통신
   - VNet 피어링을 통해 서로 다른 VNet에 존재하는 리소스들 간의 통신
2. 온-프레미스 리소스와 통신
   - 지점 및 사이트 간 VPN 이용하여 VNet과 사용자 네트워크 단일 컴퓨터 간에 통신
   - 사이트 간 VPN 이용하여 기존 구축되어 있는 온-프레미스 VPN과 Azure VPN 연동을 통해 안전한 리소스간 통신 가능
   - Azure ExpressRoute를 통한 Private 전용 통신 가능
3. 인터넷 통신
   - VNet의 오픈 리소스는 기본적으로 인터넷으로 나가는 통신(아웃바운드 통신) 가능
   - 기본적으로 인터넷으로부터 리소스로 들어오는 트래픽(인바운드)는 차단되어 있음
   - 인바운드 통신이 가능하려면 공용 IP 할당 혹은 공용부하분산장치(Azure Load Balancer) 사용

### IP 주소

- 가상 네트워크에서 IP 주소는 IPv4, IPv6 모두 사용 가능
- 공용 IPv4 주소의 한계로 일반적으로 IoT나 모바일을 위해 IPv6를 사용하여 가상 네트워크와 인터넷 연결
- IP 주소
  - 공용 IP 주소
    : 인터넷과 가상 네트워크에 연결되지 않은 다른 Azure 리소스와 인바운드, 아웃바운드 통신하는데 사용
  - 사설 IP 주소
    : 가상 네트워크. 온-프레미스 네트워크, 인터넷(NAT) 내 통신에 사용하며 VM에 하나 이상 사설 IP 주소를 할당
- 가상 네트워크에 연결된 Azure 리소스에 IP 주소를 정적, 동적으로 할당 가능. 기본값은 동적 할당
- IP 주소 표기는 CIDR 표기법 사용.

### 서브넷

- 가상 네트워크 IP 주소를 조직 및 보안을 위해 여러 개의 서브넷으로 나눌 수 있으며 다른 서브넷과 주소 범위가 겹치면 안 된다.
- Azure는 각 서브넷 내에 5개의 IP 주소를 예약 - x.x.x.0, x.x.x.1, x.x.x.2, x.x.x.3, x.x.x.255
- 가상 머신의 각 네트워크 인터페이스는 가상 네트워크에서 하나의 서브넷에 연결
- 가상 네트워크 내에서 동일하거나 다른 서브넷에 연결된 네트워크 인터페이스(NIC)는 별도의 구성없이 서로 통신가능.
  - 서브넷 간에는 보안 경계가 없다.
  - 보안 경계가 필요할 경우 네트워크 보안 그룹(NSG)를 사용한다.

### 네트워크 인터페이스

- 네트워크 인터페이스(NIC)는 가상머신(VM)과 VNet 간의 연결
- 가상머신은 하나 이상의 NIC가 필요
- 가상머신에 연결된 NIC는 가상머신과 동일한 위치(’korea central’)에 있어야 한다.
- 가상머신을 만든 후에는 VM 연결된 서브넷을 변경할 수 있지만, VNet은 변경할 수 없다.
- 가상머신에 연결된 NIC 해당 가상머신이 삭제될 때까지 유일한 MAC 주소가 할당된다.

### IP 주소 지정 계획

- Private IP
  : VPN Gateway나 ExpressRoute를 이용. 네트워크를 Azure로 확장할 때 Azure VNet 또는 온-프레미스 Network 내에서 사용
- Public IP
  : Azure 공용 서비스나 인터넷과의 통신에 사용

### 공용(Public) IP 주소 연결

| 공용 IP 주소                  | IP 주소 연결        | 동적 | 정적 |
| ----------------------------- | ------------------- | ---- | ---- |
| 가상머신                      | 네트워크 인터페이스 | 예   | 예   |
| 부하 분산 장치(load balancer) | 프런트엔드 구성     | 예   | 예   |
| VPN gateway                   | 게이트웨이 IP 구성  | 예   | 예   |
| Application gateway           | 프런트엔드 구성     | 예   | 예   |

- 정적인 공용 IP가 더 비싸다.

### 실습 - 가상 네트워크 만들기(Portal)

1. 가상 네트워크 만들기

![스크린샷 2023-07-18 오전 10.14.11.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/516324b8-76a1-458e-8314-800a52577ad6/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_10.14.11.png)

![스크린샷 2023-07-18 오전 10.16.00.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/bb5cb480-835c-4099-804b-21e21984d3cc/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_10.16.00.png)

![스크린샷 2023-07-18 오전 10.19.16.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/a7e7be9a-12c9-426b-836e-faf662b30152/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_10.19.16.png)

![스크린샷 2023-07-18 오전 10.25.19.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/7429ec4d-e33c-4a4a-9f85-cdc479fd8218/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_10.25.19.png)

![스크린샷 2023-07-18 오전 10.27.46.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/6a55acc7-45e5-44eb-9160-035fc5d4558c/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_10.27.46.png)

![스크린샷 2023-07-18 오전 10.28.11.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d36ac345-e819-4d94-b4e5-c0f0b1b339f4/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_10.28.11.png)

1. 만들어진 가상 네트워크 안에 Windows Server 가상머신 추가하기

![스크린샷 2023-07-18 오전 10.29.52.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/4fe99ebe-e9fa-4224-947f-01e15b599cf5/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_10.29.52.png)

![스크린샷 2023-07-18 오전 10.30.51.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/479494be-a85f-4e51-8446-e9a3639f6b42/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_10.30.51.png)

![스크린샷 2023-07-18 오전 10.32.32.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/21715984-a0b2-4fab-a70b-5626cd388dc0/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_10.32.32.png)

![스크린샷 2023-07-18 오전 10.32.40.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/63f9a364-a35d-4729-8f35-d1da4aac3c95/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_10.32.40.png)

![스크린샷 2023-07-18 오전 10.33.13.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/9a974991-b146-4555-baf1-05c968639121/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_10.33.13.png)

![스크린샷 2023-07-18 오전 10.34.15.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d5b1ffca-d934-45db-8761-fbf201fb4fdc/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_10.34.15.png)

![스크린샷 2023-07-18 오전 10.36.20.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/be511ddf-1d20-4f01-b2a6-a44df6941c83/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_10.36.20.png)

![스크린샷 2023-07-18 오전 10.36.36.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/008b239a-b342-45ae-a135-2730e48b1186/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_10.36.36.png)

![스크린샷 2023-07-18 오전 10.43.10.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/4db3e9f9-1dfa-42ca-a5cc-fe9d000ab7e1/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_10.43.10.png)

![스크린샷 2023-07-18 오전 10.43.24.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/80b087d4-c670-4ac6-92fc-435bc1acd8d0/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_10.43.24.png)

### 네트워크 보안그룹 구현

- 네트워크 트래픽을 한 가상 네트워크의 리소스로 제한

![스크린샷 2023-07-18 오전 11.07.07.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/55756920-ac30-4824-9f8d-ac35a9134cb5/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_11.07.07.png)

### 네트워크 보안그룹 - 유효 규칙 확인

- 네트워크 트래픽이 허용되려면 NSG1, NSG2 모두에 `허용` 규칙이 있어야 함.
- 적용되는 보안 규칙을 잘 모를 경우 유효한 보안 규칙 링크를 통해 확인

![스크린샷 2023-07-18 오전 11.10.05.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/8aedd52b-abc4-4dab-b06b-439bb301d46d/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_11.10.05.png)

### 네트워크 보안그룹 - 규칙만들기

![스크린샷 2023-07-18 오전 11.14.46.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/cc302782-1a5a-4182-814a-a2fe78234dba/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_11.14.46.png)

![스크린샷 2023-07-18 오전 11.15.28.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/445c6911-37a5-4cee-80b1-aa97635931ab/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_11.15.28.png)

- Disconnect 하고 다시 연결

![스크린샷 2023-07-18 오전 11.16.43.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/120ff570-fe3a-4fdc-80ac-4817f9476613/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_11.16.43.png)

⇒ 연결이 되지 않는다.

<aside>
💡 **숫자가 적을 수록 우선순위가 높다.**

</aside>

- 300번은 연결이고 291번은 거부인데, 291번이 더 숫자가 적어 우선순위가 높으므로 연결이 거부된다.

**다시 연결시켜보자. ⇒ 우선순위 변경**

![스크린샷 2023-07-18 오전 11.19.46.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/cd5f4b01-f07b-4fd6-8913-62a09184a780/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_11.19.46.png)

![스크린샷 2023-07-18 오전 11.21.01.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/ae194796-4b6d-4b6c-9a1b-c77dac7273b1/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_11.21.01.png)

⇒ 다시 연결된다!

## 가상 네트워크 피어링

---

### 가상 네트워크 피어링

: 2개의 가상 네트워크를 각각 peer-to-peer로 양방향 연결

- 피어링된 가상 네트워크 간의 트래픽은 **마이크로소프트 백본인프라** 사용
- 지원되는 피어링 유형
  - 가상 네트워크 피어링 : 동일한 Azure 지역 내에 있는 VNet 연결
  - 글로벌 가상 네트워크 피어링 : 서로 다른 지역에 존재하는 VNet 연결

### 이점

- 피어링된 가상 네트워크 리소스 간의 통신에 공용인터넷, 게이트웨이, 또는 암호화가 필요없다.
- 피어링된 가상 네트워크 리소스 간에 짧은 대기 시간과 높은 대역폭 연결
- 네트워크 트래픽이 Microsoft 백본 네트워크에서 유지되며 프라이빗 전용
- 피어링을 만들 때 또는 피어링이 생성된 후에 가상 네트워크에 있는 리소스에 대한 가동 중지 시간이 불필요
- 다른 Azure 지역에서 가상 네트워크 간에 데이터 전송 가능

### 실습 - 가상 네트워크 피어링

1. 같은 지역 내에 2개의 가상 네트워크 만들기
2. 각 가상 네트워크에 1의 VM 만들기(첫번째 VM은 공용 IP, 두번째 VM 공용 IP 제외)
3. RDP로 첫번째 VM 연결한 후 RDP로 두 번째 VM 연결 테스트
4. 2개의 VNET vldjfld
5. 연결 테스트

![스크린샷 2023-07-18 오전 11.35.24.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/c1fe8326-3b6c-4ad2-98d5-2f1aacef8176/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_11.35.24.png)

![스크린샷 2023-07-18 오전 11.37.16.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/7303d5e0-fed1-4d20-b24c-9246f3c0b4ee/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_11.37.16.png)

![스크린샷 2023-07-18 오전 11.39.15.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/ff493261-05f5-426c-aa96-49bdb243efa2/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_11.39.15.png)

![스크린샷 2023-07-18 오전 11.41.46.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/575b74bc-0a81-44d6-a784-30ae7f979088/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_11.41.46.png)

![스크린샷 2023-07-18 오전 11.42.07.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/5aae98b4-6a39-4872-b80d-1180c7216e89/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_11.42.07.png)

![스크린샷 2023-07-18 오전 11.42.23.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/82ac5771-83a3-4c5e-8e8e-95ecb1147fe9/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_11.42.23.png)

![스크린샷 2023-07-18 오전 11.45.57.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e81738b7-eae1-4337-a6da-6355d785bab3/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_11.45.57.png)

![스크린샷 2023-07-18 오후 12.01.20.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d0fdd51c-1db3-4f48-af42-fcea23d86613/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_12.01.20.png)

![스크린샷 2023-07-18 오후 12.03.39.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/28501fef-b0a3-4253-b87e-932a826b706c/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_12.03.39.png)

![스크린샷 2023-07-18 오후 12.04.08.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/dc400058-4b85-405b-a7dc-dab3191caf94/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_12.04.08.png)

![스크린샷 2023-07-18 오후 12.04.17.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/6cc25de0-d921-4f91-be38-270bbbea4003/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_12.04.17.png)

![스크린샷 2023-07-18 오후 12.06.31.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d071ae7f-cf7f-473a-86a3-eaa50ac53747/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_12.06.31.png)

<aside>
💡 **왜 연결됐을까?**

</aside>

- 공용 IP니까

- 다시 두번째 vm을 disconnect 하자.

![스크린샷 2023-07-18 오후 12.08.09.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/2cac57b3-5a6a-411b-b6f6-7a2d823d175a/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_12.08.09.png)

![스크린샷 2023-07-18 오후 12.12.16.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/65538fe8-b0c7-422d-83b9-5feb22bf8bc8/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_12.12.16.png)

![스크린샷 2023-07-18 오후 12.12.26.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/eca95726-e475-4921-b680-e090936bd243/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_12.12.26.png)

![스크린샷 2023-07-18 오후 12.12.37.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/7ab282ae-57cb-46fe-a561-8d5f6a82391d/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_12.12.37.png)

![스크린샷 2023-07-18 오후 12.13.19.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/80d28abb-32c6-4fa0-9a77-7ed7bfe07e94/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_12.13.19.png)

**[ 다시 연결을 시도해보자 ]**

![스크린샷 2023-07-18 오후 12.16.09.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/7910ba84-00f7-433c-b400-10da18d3104e/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_12.16.09.png)

⇒ 연결이 되지 않는다.

- 첫번째 공용 IP를 안쓴다고 설정했기 때문

**[ Private IP도 연결되지 않는다. ]**

![스크린샷 2023-07-18 오후 12.17.16.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e03e4ca3-e44d-4e82-9493-ee9c09ffc4f3/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_12.17.16.png)

**[ 피어링을 하자 ]**

![스크린샷 2023-07-18 오후 12.18.18.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/222c2b11-9bfa-4b24-9884-4e135ae45d26/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_12.18.18.png)

![스크린샷 2023-07-18 오후 12.21.17.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/4e25c567-8257-4f69-b270-ab80549c14d2/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_12.21.17.png)

![스크린샷 2023-07-18 오후 12.22.31.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/baf25dbc-d4b7-48aa-9cb6-b88c34bc6b12/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_12.22.31.png)

![스크린샷 2023-07-18 오후 12.23.02.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/06699718-53fe-4854-825e-be87969c0be4/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_12.23.02.png)

![스크린샷 2023-07-18 오후 12.23.40.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/bbde6126-c834-4c17-b952-75cb596b0ef9/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_12.23.40.png)

![스크린샷 2023-07-18 오후 12.24.01.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/7609bdbe-d3cd-4b18-9b36-4590fe058e91/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_12.24.01.png)

![스크린샷 2023-07-18 오후 12.25.04.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/f4751ee2-81c1-467e-aa24-f4484cc620c4/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_12.25.04.png)

⇒ 선이 생겼다 (피어링이 되었다.)

## VPN

---

### VPN

: 가상 사설 네트워크는 인터넷상에서 안전하게 사설 네트워크 연결이 가능하게 하는 기술

- VPN은 공용 IP 주소를 할당받아 인터넷에 연결하는 부분. 사설 IP를 할당받아 내부 네트워크에 연결하는 부분으로 나뉘며 최소 2개 이상(외부 핸들링, 내부 핸들링)의 네트워크 인터페이스 제공

### VPN Gateway

: 공용 인터넷을 통해 Azure 가상 네트워크와 온-프레미스 위치 간에 암호화된 트래픽 전송을 위한 소프트웨어 VPN 디바이스

- 각 가상 네트워크에는 VPN Gateway가 1개만 존재
- VPN Gateway를 사용하여 두 가상 네트워크 간에 VPN 연결 설정

### 사이트 간(S2S) VPN 연결 만들기

1. 게이트웨이 서브넷 만들기
2. VPN Gateway 만들기
3. 로컬 네트워크 게이트웨이 만들기
4. VPN 디바이스 구성
5. VPN 연결 만들기

### VPN Gateway 서브넷 만들기

1. 게이트웨이 서브넷을 만들면 게이트웨이 VM이 게이트웨이 서브넷에 배포되고 필요한 VPN Gateway 설정으로 구성됨
2. 게이트웨이 서브넷에는 IP 주소가 포함됨. 가능하면 CIDR 블록 /28 또는 /27을 사용
3. 게이트웨이 서브넷에 다른 리소스(ex. 추가 VM)는 배포하지 말 것
4. 대부분의 VPN 형식은 라우팅/경로 테이블에서 경로를 사용해서 트래픽을 IPSec 터널 인터페이스로 보내는 경로기반 사용
5. 게이트웨이 SKU 선택에 따라 소유할 수 있는 연결의 수와 처리량 벤치마크가 달라진다.
6. 게이트웨이 서브넷이 포함된 가상 네트워크를 연결하여 공용 IP 필요
7. active-active 모드나 2개 이상의 네트워크 간 라우팅 정보를 교환하는 BGP 프로토콜은 고가용성 구성에 적합하다.

### VPN 연결 만들기

1. VPN 게이트웨이가 만들어지고 온-프레미스 디바이스가 구성되면 연결 개체를 만든다.
2. 연결의 이름을 구성하고 유형을 사이트 간으로 지정한다.
3. VPN 게이트웨이 및 로컬 네트워크 게이트웨이를 선택한다.
4. 연결용 공유 키를 입력한다.

### 실습

1. vnet1 : 192.168.0.0/16
   - 서브넷 snetfront
2. vnet2: 192.168.2.0/24
   - 서브넷

![스크린샷 2023-07-18 오후 2.37.47.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/5d68acee-26e4-44bc-97fb-9c7b205be84b/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.37.47.png)

![스크린샷 2023-07-18 오후 2.39.16.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e0464d6c-80e6-474d-a676-34e07fa52045/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.39.16.png)

![스크린샷 2023-07-18 오후 2.44.19.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/3eea8b73-188f-40a2-9e80-c9db17141d21/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.44.19.png)

![스크린샷 2023-07-18 오후 3.01.33.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d0f14faa-6eb3-4d09-98e9-da4358e5a41c/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_3.01.33.png)

## 가상 머신 확장 집합

---

### 가상 머신 확장 집합(VMSS)

: 부하 분산된 VM 그룹을 생성하고 관리 가능

- VMSS는 Azure Portal에서 VM을 생성한 것과 다르게 다르게 VM을 정의된 일정이나 요구사항에 따라서 자동으로 생성하거나 제거할 수 있다.

### 장점

1. 다수 VM 생성 및 관리의 단순화
2. 고가용성 및 애플리케이션 복원력 제공
3. 리소스 수요 변화에 따라 자동으로 애플리케이션 크기 조정

## Azure Load Balancer(L4)

---

### 부하 분산 장치 솔루션

| 기능     | Application Gateway                                                                                     | Load Balancer                                                                       | Traffic Manager                                                                     |
| -------- | ------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------- |
| 사용     | 웹 어플리케이션 방화벽을 사용하여 애플리케이션 보안을 강화하면서 애플리케이션의 서버 팜의 배달을 최적화 | 애플리케이션 또는 서버 앤드포인트에 대한 인바운드 및 아웃바운드 연결 및 요청의 분산 | 고가용성 및 응답성을 제공. 글로벌 Azure 지역 전반의 서비스에 트래픽을 최적으로 분산 |
| 프로토콜 | HTTP, HTTPS, HTTP2                                                                                      | TCP, UDP                                                                            | 모두                                                                                |
| 프라이빗 | 예                                                                                                      | 예                                                                                  |                                                                                     |
| 전역     |                                                                                                         |                                                                                     | 예                                                                                  |
| 환경     | Azure, 비 Azure 클라우드, 온-프레미스                                                                   | Azure                                                                               | Azure, 비 Azure 클라우드, 온-프레미스                                               |
| 보안     | WAF                                                                                                     | NSG                                                                                 |                                                                                     |

<aside>
💡 **Health Check를 통해 계속 작업하고 있는지 확인한다.**

</aside>

- 응답이 없으면 트래픽 주지 않음

### 내부 부하 분산 장치 구성요소

1. 백 엔드 풀

   : 들어오는 요청에 대해 처리할 가상 머신 세트를 지정

2. 상태 프로브

   : 백 엔드 풀의 가상머신 상태 모니터링

3. 부하 분산 규칙

   : 백 엔드 풀의 가상 머신에 트래픽 분산시키는 방법 정의.

   - 원본 IP와 포트, 대상 IP와 포트, 프로토콜을 포함하는 5 튜플 해시 기반 분산 처리

4. 인바인드 NAT

   : 프런트엔드 IP와 포트번호의 조합으로 들어오는 트래픽을 해시기반 분산 처리를 통해 백 엔드 풀의 특정 VM으로 전달

### 실습 - Load Balancer 구현

1. 가상 네트워크와 서브넷 만들기
2. 백엔드 풀로 사용할 가상머신 만들기 (2대의 Linux VM)
3. 부하 분산 장치 검색, 만들기
4. 백엔드 풀, 상태 프로브, 부하 분산 규칙, 인바인드 NAT 규칙 확정

![스크린샷 2023-07-18 오후 3.44.43.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/9f2766d2-22c8-4f97-a8e2-2d745fde9522/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_3.44.43.png)

![스크린샷 2023-07-18 오후 4.07.39.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e89c4df4-d8b9-4bca-aa51-dc71f81c5127/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.07.39.png)

![스크린샷 2023-07-18 오후 4.09.11.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/009b540d-277b-4064-9c26-a5d5d83a9e99/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.09.11.png)

![스크린샷 2023-07-18 오후 4.10.59.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/a24e89e0-3ebb-4b7b-97db-7e3ae2ab19d8/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.10.59.png)

![스크린샷 2023-07-18 오후 4.11.26.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/b727744a-8811-443e-b270-598399321f9b/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.11.26.png)

![스크린샷 2023-07-18 오후 4.11.39.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/4e54a51e-d059-4c4e-8855-b6a132a43f9e/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.11.39.png)

![스크린샷 2023-07-18 오후 4.14.07.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d1ceb207-2002-435b-86cc-eb6f8f36354b/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.14.07.png)

![스크린샷 2023-07-18 오후 4.18.15.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/f550a335-a5ef-44ae-9727-60594804360e/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.18.15.png)

![스크린샷 2023-07-18 오후 4.20.59.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/64754e9a-afc7-449b-83e4-3dcf7cc91129/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.20.59.png)

![스크린샷 2023-07-18 오후 4.23.26.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/548a182d-f550-4866-949d-009cb25306dd/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.23.26.png)

![스크린샷 2023-07-18 오후 4.28.18.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/14524f5e-eeef-45bb-91ca-b7f835e65516/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.28.18.png)

![스크린샷 2023-07-18 오후 4.30.56.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/23340ed0-6361-4026-9e9f-dd24d33084ae/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.30.56.png)

![스크린샷 2023-07-18 오후 4.33.03.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/6aede59c-0d18-42d3-aba9-2559650fa8cf/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.33.03.png)

![스크린샷 2023-07-18 오후 4.33.32.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/4fb63c59-45ed-4940-81a6-503ab1604242/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.33.32.png)

![스크린샷 2023-07-18 오후 4.36.16.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/3c2415ff-9a6e-4c11-ad40-6925f812ffe3/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.36.16.png)

![스크린샷 2023-07-18 오후 4.37.06.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/cb790af1-558f-476e-ae53-b0b5279d477c/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.37.06.png)

![스크린샷 2023-07-18 오후 4.37.14.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/3881d587-34b7-4b22-916c-d383953e7cdb/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.37.14.png)

![스크린샷 2023-07-18 오후 4.37.25.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d161b96b-4c97-4197-b471-0bec585481eb/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.37.25.png)

![스크린샷 2023-07-18 오후 4.38.24.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/51047f57-14a7-49e3-88e4-67811a249ed1/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.38.24.png)

![스크린샷 2023-07-18 오후 4.38.37.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/ddf817f6-fc77-4ebe-9f86-005874f05b35/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.38.37.png)

![스크린샷 2023-07-18 오후 4.39.03.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/a9e89275-e1f8-4025-8d4e-9d5ea80a9fba/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.39.03.png)

![스크린샷 2023-07-18 오후 4.39.25.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/942ff8c6-d7e2-4447-9b33-92b4c4a1af55/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.39.25.png)

![스크린샷 2023-07-18 오후 4.41.31.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/f86628ff-414e-4e7d-bb84-bbcd9acd0a9d/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.41.31.png)

![스크린샷 2023-07-18 오후 4.42.14.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/fc7322be-ae76-4ae5-929a-d5d5e60b8d72/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.42.14.png)

![스크린샷 2023-07-18 오후 4.43.09.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/c18e230f-843d-48af-9a16-6709501c81a0/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.43.09.png)

![스크린샷 2023-07-18 오후 4.44.53.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/ed3187ea-2ca1-4ad3-bf03-ba70bf583003/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.44.53.png)

![스크린샷 2023-07-18 오후 4.45.27.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/5c9dc3d7-32d3-4b6c-967d-40a1452b888f/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.45.27.png)

![스크린샷 2023-07-18 오후 4.46.06.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/619e5aa9-5b1c-40c6-b438-bbe23595ebcc/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.46.06.png)

```bash
#!/bin/bash

# 패키지 소스 업데이트
apt-get -y update

# nginx 설치
apt-get -y install nginx

# index.html 만들기
fileName=/var/www/html/index.html
echo "<html><head><title>Load Balancer</title></head><body>
Runing Web Server from vmnetce01</body><html>" > ${fileName}
```

```bash
#!/bin/bash

# 패키지 소스 업데이트
apt-get -y update

# nginx 설치
apt-get -y install nginx

# index.html 만들기
fileName=/var/www/html/index.html
echo "<html><head><title>Load Balancer</title></head><body>
Runing Web Server from vmnetce02</body><html>" > ${fileName}
```

![스크린샷 2023-07-18 오후 5.11.56.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/64512c4c-3aba-4fa8-bb4f-1c430e9d478b/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_5.11.56.png)

![스크린샷 2023-07-18 오후 5.12.24.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/2d190a8d-ff9b-4901-b544-f017b9f78610/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_5.12.24.png)

![스크린샷 2023-07-18 오후 5.12.51.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/3204bb9a-d08b-46d9-9d35-b753b9120ee4/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_5.12.51.png)

![스크린샷 2023-07-18 오후 5.14.41.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/145b7d1d-1aa3-4684-b3a7-75cb6de4f233/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_5.14.41.png)

![스크린샷 2023-07-18 오후 5.15.08.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/baef070b-113d-452d-9d3b-8ed7fbd80ef8/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_5.15.08.png)

![스크린샷 2023-07-18 오후 5.15.49.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/80049e6b-c184-437a-8b26-6cc99ed24b6c/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_5.15.49.png)

![스크린샷 2023-07-18 오후 5.16.24.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/20669442-6f19-4ca5-ac49-014b81e7df5a/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_5.16.24.png)

![스크린샷 2023-07-18 오후 5.17.00.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/ac35009c-7266-469e-a558-a2c0cf799dad/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_5.17.00.png)

- 동일하게 vm2에도 만들자

![스크린샷 2023-07-18 오후 5.18.34.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/96a50fb2-8c50-4779-91c6-be00101bae31/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_5.18.34.png)

![스크린샷 2023-07-18 오후 5.19.20.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/95572753-3a38-4fcb-8201-e266084c7326/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_5.19.20.png)

![스크린샷 2023-07-18 오후 5.20.09.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/914b4c38-92f2-437a-93f6-0d195640fa92/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_5.20.09.png)

![스크린샷 2023-07-18 오후 5.20.52.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/62b92c62-2010-4f22-b8c5-4d13101a8c59/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_5.20.52.png)

![스크린샷 2023-07-18 오후 5.26.36.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/20380764-80e8-4237-a388-0c31b3228727/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2023-07-18_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_5.26.36.png)
